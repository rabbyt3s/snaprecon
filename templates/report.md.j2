# SnapRecon Report

**Run ID:** {{ results.run_id }}  
**Timestamp:** {{ results.timestamp.strftime('%Y-%m-%d %H:%M:%S UTC') }}  
**Mode:** Local analysis

## Summary

- **Total Targets:** {{ results.targets|length }}
- **Successful Screenshots:** {{ success_count }}
- **Failed Screenshots:** {{ error_count }}
- **Successful Analyses:** {{ results.targets|selectattr('analysis')|list|length }}

## Configuration

- **Output Directory:** {{ config.run_dir }}
- **Scan Profile:** {{ config.scan_profile|capitalize }}
- **Concurrency:** {{ config.concurrency }}
- **Timeout:** {{ config.timeout_ms }}ms
- **Full Page Screenshots:** {{ "Yes" if config.fullpage else "No" }}

## Results by Status

### Successful Targets

{% for target in targets_by_status.success %}
#### {{ target.host }}
- **Domain:** {{ target.domain }}
- **Subdomain:** {{ target.subdomain or "None" }}
- **Title:** {{ target.metadata.title or "N/A" }}
- **Status Code:** {{ target.metadata.status_code or "N/A" }}
- **Final URL:** {{ target.metadata.final_url or "N/A" }}
- **Screenshot Size:** {{ target.metadata.screenshot_size or "N/A" }} bytes
{% if target.metadata.technologies %}- **Technologies:** {{ target.metadata.technologies | map(attribute='name') | list | join(', ') }}{% endif %}

{% if target.analysis %}
**Analysis Results:**
-- **Summary:** {{ target.analysis.summary }}
-- **Tags:** {{ target.analysis.tags|join(', ') }}
-- **Interesting:** {% if target.analysis.confidence >= 0.85 %}RED{% elif target.analysis.confidence >= 0.6 %}AMBER{% else %}GREEN{% endif %}
{% endif %}

---
{% endfor %}

### Failed Targets

{% for target in targets_by_status.error %}
#### {{ target.host }}
- **Error:** {{ target.error.message }}
- **Error Code:** {{ target.error.code or "N/A" }}
{% if target.error.details %}
- **Details:** {{ target.error.details }}
{% endif %}

---
{% endfor %}

## Tags Summary

{% set all_tags = [] %}
{% for target in results.targets %}
    {% if target.analysis %}
        {% for tag in target.analysis.tags %}
            {% set _ = all_tags.append(tag) %}
        {% endfor %}
    {% endif %}
{% endfor %}

{% if all_tags %}
**Most Common Tags:**
{% set tag_counts = {} %}
{% for tag in all_tags %}
    {% if tag in tag_counts %}
        {% set _ = tag_counts.update({tag: tag_counts[tag] + 1}) %}
    {% else %}
        {% set _ = tag_counts.update({tag: 1}) %}
    {% endif %}
{% endfor %}
{% for tag, count in tag_counts.items()|sort(attribute='1', reverse=true) %}
- {{ tag }} ({{ count }})
{% endfor %}
{% endif %}

---

*Report generated by SnapRecon v0.1.0*
